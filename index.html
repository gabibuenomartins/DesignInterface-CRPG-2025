<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MB Calçados</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<header>
    <h2>MB Calçados</h2>
    <nav>
        <a href="index.html">Início</a>
        <a href="filiais.html">Categorias</a>
        <a href="contato.html">Contato</a>
        <a href="planilha.html">Estoque</a>
    </nav>
</header>

<main>
    <h1>Bem-vindo à MB Calçados</h1>
    <p>Encontre tênis e calçados com conforto, estilo e preço justo.</p>

    <div id="conteudo" class="conteudo-scroll">
        <p>Carregando produtos...</p>
    </div>
</main>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyJ4-2DojRiVQVnVMoMRiFdXB9Rgj1UTIM7A-uFTotiMiMOyCuw1sghPmegbVMRevR6JA/exec";

const tenisFotos = [
    "https://images.unsplash.com/photo-1528701800489-20be0b2f81ee",
    "https://images.unsplash.com/photo-1606813906428-e5233ffcd1d3",
    "https://images.unsplash.com/photo-1542296332-2e4473faf563",
    "https://images.unsplash.com/photo-1600180758895-1c1a99c37e4a",
    "https://images.unsplash.com/photo-1530460944061-8fcd61f52c30"
];

async function carregarConteudo() {
    const container = document.getElementById('conteudo');
    container.innerHTML = "<p>Carregando produtos...</p>";

    try {
        const res = await fetch(SCRIPT_URL);
        const dados = await res.json();
        container.innerHTML = '';

        dados.forEach(item => {
            const bloco = document.createElement('div');
            bloco.className = 'bloco-item';

            const titulo = document.createElement('h2');
            titulo.textContent = item.Título || 'Tênis disponível';
            bloco.appendChild(titulo);

            const descricao = document.createElement('p');
            descricao.textContent = item.Descrição || 'Modelo de tênis disponível em nosso catálogo.';
            bloco.appendChild(descricao);

            if (item.Url && item.Url.startsWith('http')) {
                const youtubeRegex = /(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]+)/;
                const match = item.Url.match(youtubeRegex);

                if (match) {
                    const iframe = document.createElement('iframe');
                    iframe.src = `https://www.youtube.com/embed/${match[1]}`;
                    iframe.width = "75%";
                    iframe.height = "315";
                    iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
                    iframe.setAttribute("allowfullscreen", true);
                    bloco.appendChild(iframe);
                }
                else if (item.Url.match(/\.(jpg|jpeg|png|gif|webp)$/i) || item.Url.includes('unsplash')) {
                    const img = document.createElement('img');
                    img.src = item.Url;

                    img.onerror = () => {
                        img.src = tenisFotos[Math.floor(Math.random() * tenisFotos.length)];
                    };

                    img.alt = "Tênis MB Calçados";
                    bloco.appendChild(img);
                }
                else {
                    const link = document.createElement('a');
                    link.href = item.Url;
                    link.textContent = 'Ver detalhes';
                    bloco.appendChild(link);
                }
            }

            container.appendChild(bloco);
        });

    } catch (err) {
        container.innerHTML = "<p>Erro ao carregar produtos: " + err.message + "</p>";
    }
}

carregarConteudo();
</script>

<footer>
    <p>&copy; MB Calçados</p>
</footer>

</body>
</html>
